"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[3217],{4852:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>u});var o=n(9231);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var c=o.createContext({}),d=function(e){var t=o.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},m=function(e){var t=d(e.components);return o.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},l=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,c=e.parentName,m=r(e,["components","mdxType","originalType","parentName"]),l=d(n),u=a,g=l["".concat(c,".").concat(u)]||l[u]||p[u]||i;return n?o.createElement(g,s(s({ref:t},m),{},{components:n})):o.createElement(g,s({ref:t},m))}));function u(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,s=new Array(i);s[0]=l;var r={};for(var c in t)hasOwnProperty.call(t,c)&&(r[c]=t[c]);r.originalType=e,r.mdxType="string"==typeof e?e:a,s[1]=r;for(var d=2;d<i;d++)s[d]=n[d];return o.createElement.apply(null,s)}return o.createElement.apply(null,n)}l.displayName="MDXCreateElement"},6284:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>d,toc:()=>p});var o=n(2203),a=(n(9231),n(4852)),i=n(3374),s=n(9448);const r={},c="Data composition",d={unversionedId:"guides/data-composition",id:"guides/data-composition",title:"Data composition",description:"Data composition is at the heart of ComposeDB, using composites as a proxy for datasets of documents relevant to applications and services.",source:"@site/docs/guides/data-composition.mdx",sourceDirName:"guides",slug:"/guides/data-composition",permalink:"/docs/next/guides/data-composition",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Concepts overview",permalink:"/docs/next/guides/concepts-overview"},next:{title:"Using composites",permalink:"/docs/next/category/using-composites"}},m={},p=[{value:"Models composition",id:"models-composition",level:2},{value:"Relations",id:"relations",level:2},{value:"Account to document",id:"account-to-document",level:3},{value:"Account to single document",id:"account-to-single-document",level:4},{value:"Account to multiple documents",id:"account-to-multiple-documents",level:4},{value:"Document to account",id:"document-to-account",level:3},{value:"Document to document",id:"document-to-document",level:3}],l={toc:p};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,o.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"data-composition"},"Data composition"),(0,a.kt)("p",null,"Data composition is at the heart of ComposeDB, using ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#composites"},"composites")," as a proxy for datasets of ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#documents"},"documents")," relevant to applications and services."),(0,a.kt)("p",null,"Composites represent sets of ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#models"},"models")," that can be used to query, create and update documents, therefore it is important for developers to identify models to use, whether by ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/using-composites/discovery"},"reusing models already adopted by the ecosystem")," in order to access the set of documents already created using these models, or ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/overview"},"creating new models")," that would better suit specific needs."),(0,a.kt)("h2",{id:"models-composition"},"Models composition"),(0,a.kt)("p",null,"The following schema describes how composites can be created by ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/using-composites/customization#merging-composites"},"merging existing composites")," (composites ",(0,a.kt)("inlineCode",{parentName:"p"},"D")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"A'")," below) and ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/using-composites/customization#extracting-models"},"extracting models from a composite")," (composites ",(0,a.kt)("inlineCode",{parentName:"p"},"E")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"F")," below)."),(0,a.kt)("p",null,"The same datasets can be represented by different composites, such as the composites ",(0,a.kt)("inlineCode",{parentName:"p"},"A")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"A'")," below that contain the same models."),(0,a.kt)(s.Z,{alt:"Models composition schema",sources:{light:(0,i.Z)("/img/models-composition-light.png"),dark:(0,i.Z)("/img/models-composition-dark.png")},mdxType:"ThemedImage"}),(0,a.kt)("h2",{id:"relations"},"Relations"),(0,a.kt)("p",null,"The ComposeDB graph representation supports the following types of edges (relations) between nodes:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#account-to-document"},"Account to document"),", with two variants:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},"Single: an ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#accounts"},"account")," can only be related to ",(0,a.kt)("strong",{parentName:"li"},"one")," ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#documents"},"document")," of a given ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#models"},"model"),"."),(0,a.kt)("li",{parentName:"ul"},"Multiple: an ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#accounts"},"account")," can be related to ",(0,a.kt)("strong",{parentName:"li"},"many")," ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#documents"},"documents")," of a given ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#models"},"model"),"."))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#document-to-account"},"Document to account"),": a ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#documents"},"document")," can contain properties storing relations to an ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#accounts"},"account"),"."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"#document-to-account"},"Document to document"),": a ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#documents"},"document")," can contain properties storing relations to another ",(0,a.kt)("a",{parentName:"li",href:"/docs/next/guides/concepts-overview#documents"},"document"),".")),(0,a.kt)("p",null,"Direct edges between accounts are ",(0,a.kt)("strong",{parentName:"p"},"not supported")," by ComposeDB, but relations can be defined indirectly by using an intermediary ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#documents"},"document"),"."),(0,a.kt)("h3",{id:"account-to-document"},"Account to document"),(0,a.kt)("p",null,"The relations between documents and the account controlling (having created and being able to update) them are defined in the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#models"},"model")," used by the document."),(0,a.kt)("p",null,"ComposeDB currently supports two variants for these relations:"),(0,a.kt)("h4",{id:"account-to-single-document"},"Account to single document"),(0,a.kt)("p",null,"This variant ensures the indexing service stores ",(0,a.kt)("strong",{parentName:"p"},"at most one document")," of the given model for the account. This can be useful notably to store a profile or similar information."),(0,a.kt)("p",null,"These relations can be defined when creating new models, using the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#createmodel"},(0,a.kt)("inlineCode",{parentName:"a"},"@createModel")," directive")," with the ",(0,a.kt)("inlineCode",{parentName:"p"},"accountRelation")," argument set to ",(0,a.kt)("inlineCode",{parentName:"p"},"SINGLE"),"."),(0,a.kt)("h4",{id:"account-to-multiple-documents"},"Account to multiple documents"),(0,a.kt)("p",null,"This variant allows ",(0,a.kt)("strong",{parentName:"p"},"any number of documents")," of a given model to be associated to the account."),(0,a.kt)("p",null,"These relations can be defined when creating new models, using the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#createmodel"},(0,a.kt)("inlineCode",{parentName:"a"},"@createModel")," directive")," with the ",(0,a.kt)("inlineCode",{parentName:"p"},"accountRelation")," argument set to ",(0,a.kt)("inlineCode",{parentName:"p"},"LIST"),"."),(0,a.kt)("h3",{id:"document-to-account"},"Document to account"),(0,a.kt)("p",null,"The ComposeDB runtime logic automatically replaces ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/scalars#did"},(0,a.kt)("inlineCode",{parentName:"a"},"DID")," scalars")," defined in a schema by ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/interacting/queries#ceramicaccount-object"},(0,a.kt)("inlineCode",{parentName:"a"},"CeramicAccount")," objects"),", allowing to access the documents associated to the given account."),(0,a.kt)("p",null,"In order to make these fields directly queryable from the index, the schema must use the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#accountreference"},(0,a.kt)("inlineCode",{parentName:"a"},"@accountReference")," directive")," on these fields."),(0,a.kt)("h3",{id:"document-to-document"},"Document to document"),(0,a.kt)("p",null,"Relations between documents can be defined on fields using the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/scalars#streamid"},(0,a.kt)("inlineCode",{parentName:"a"},"StreamID")," scalar")," with the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#documentreference"},(0,a.kt)("inlineCode",{parentName:"a"},"@documentReference")," directive")," specifying the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/concepts-overview#models"},"model")," the related document must use. This allows to define ",(0,a.kt)("strong",{parentName:"p"},"many-to-one"),' relations between documents, for example many "comment" documents to a single "post" document.'),(0,a.kt)("p",null,"Using the ComposeDB runtime, the associated document can be accessed directly if a view using the ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#relationdocument"},(0,a.kt)("inlineCode",{parentName:"a"},"@relationDocument")," directive")," is defined in the model."),(0,a.kt)("p",null,"It is also possible to represent ",(0,a.kt)("strong",{parentName:"p"},"one-to-many"),' relations, for example one "post" document to many "comment" documents, by using the ',(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#relationfrom"},(0,a.kt)("inlineCode",{parentName:"a"},"@relationFrom"))," and ",(0,a.kt)("a",{parentName:"p",href:"/docs/next/guides/creating-composites/directives#relationcountfrom"},(0,a.kt)("inlineCode",{parentName:"a"},"@relationCountFrom"))," directives to represent the other side of the relations."))}u.isMDXComponent=!0}}]);