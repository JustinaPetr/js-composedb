"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[9004],{4852:(e,n,t)=>{t.d(n,{Zo:()=>s,kt:()=>u});var i=t(9231);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function a(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?a(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):a(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,i,r=function(e,n){if(null==e)return{};var t,i,r={},a=Object.keys(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)t=a[i],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var c=i.createContext({}),d=function(e){var n=i.useContext(c),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},s=function(e){var n=d(e.components);return i.createElement(c.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var t=e.components,r=e.mdxType,a=e.originalType,c=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),m=d(t),u=r,f=m["".concat(c,".").concat(u)]||m[u]||p[u]||a;return t?i.createElement(f,o(o({ref:n},s),{},{components:t})):i.createElement(f,o({ref:n},s))}));function u(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var a=t.length,o=new Array(a);o[0]=m;var l={};for(var c in n)hasOwnProperty.call(n,c)&&(l[c]=n[c]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var d=2;d<a;d++)o[d]=t[d];return i.createElement.apply(null,o)}return i.createElement.apply(null,t)}m.displayName="MDXCreateElement"},2750:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>a,metadata:()=>l,toc:()=>d});var i=t(2203),r=(t(9231),t(4852));const a={},o="Ceramic configuration",l={unversionedId:"configuration",id:"configuration",title:"Ceramic configuration",description:"Ceramic functionalities supporting ComposeDB are currently considered",source:"@site/docs/configuration.md",sourceDirName:".",slug:"/configuration",permalink:"/docs/0.3.x/configuration",draft:!1,tags:[],version:"current",frontMatter:{},sidebar:"docs",previous:{title:"Installation",permalink:"/docs/0.3.x/installation"},next:{title:"Your first composite",permalink:"/docs/0.3.x/first-composite"}},c={},d=[{value:"Environment variable",id:"environment-variable",level:2},{value:"Admin DIDs",id:"admin-dids",level:2},{value:"Generating a DID private key",id:"generating-a-did-private-key",level:3},{value:"Getting the DID value",id:"getting-the-did-value",level:3},{value:"Configuration file",id:"configuration-file",level:2}],s={toc:d};function p(e){let{components:n,...t}=e;return(0,r.kt)("wrapper",(0,i.Z)({},s,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"ceramic-configuration"},"Ceramic configuration"),(0,r.kt)("p",null,"Ceramic functionalities supporting ComposeDB are currently considered\nexperimental and the Ceramic node must be explicitly configured to support them."),(0,r.kt)("h2",{id:"environment-variable"},"Environment variable"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"CERAMIC_ENABLE_EXPERIMENTAL_COMPOSE_DB")," environment variable must be set to\n",(0,r.kt)("inlineCode",{parentName:"p"},"true")," to run a Ceramic node with ComposeDB support, for example with a globally\ninstalled Ceramic CLI available as ",(0,r.kt)("inlineCode",{parentName:"p"},"ceramic"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"CERAMIC_ENABLE_EXPERIMENTAL_COMPOSE_DB ceramic daemon --network=inmemory\n")),(0,r.kt)("h2",{id:"admin-dids"},"Admin DIDs"),(0,r.kt)("p",null,"ComposeDB queries support relies on Ceramic nodes indexing documents using the\nmodels specified in the composite. In order to notify the Ceramic node of the\nmodels to index, the ComposeDB tools need to interact with restricted admin APIs\non Ceramic."),(0,r.kt)("p",null,"Calling the Ceramic admin APIs requires an authenticated DID to be set in the\n",(0,r.kt)("a",{parentName:"p",href:"#configuration-file"},"configuration file"),", which can be generated using the\nfollowing ComposeDB CLI commands:"),(0,r.kt)("h3",{id:"generating-a-did-private-key"},"Generating a DID private key"),(0,r.kt)("p",null,"The\n",(0,r.kt)("a",{parentName:"p",href:"/docs/0.3.x/api/commands/cli.did#composedb-didgenerate-private-key"},(0,r.kt)("inlineCode",{parentName:"a"},"did:generate-private-key")," command"),"\nof the ComposeDB CLI can be used to generate a random private key for a DID:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"composedb did:generate-private-key\n")),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"The generated private key must be securely stored so it can be used when\ninteracting with other commands of the ComposeDB CLI when set as the\n",(0,r.kt)("inlineCode",{parentName:"p"},"DID_PRIVATE_KEY")," environment variable or ",(0,r.kt)("inlineCode",{parentName:"p"},"--did-private-key")," flag, and\ndevelopment tools APIs.")),(0,r.kt)("h3",{id:"getting-the-did-value"},"Getting the DID value"),(0,r.kt)("p",null,"The DID string value can be accessed based on a known private key generated in\nthe step above by using the\n",(0,r.kt)("a",{parentName:"p",href:"/docs/0.3.x/api/commands/cli.did#composedb-didfrom-private-key"},(0,r.kt)("inlineCode",{parentName:"a"},"did:from-private-key")," command"),"\nof the ComposeDB CLI:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"composedb did:from-private-key [hexadecimal-encoded private key string]\n")),(0,r.kt)("p",null,"The DID string can then be set in the Ceramic node configuration file as\ndescribed below."),(0,r.kt)("h2",{id:"configuration-file"},"Configuration file"),(0,r.kt)("p",null,"The Ceramic node configuration file, which defaults to\n",(0,r.kt)("inlineCode",{parentName:"p"},"~/.ceramic/daemon.config.json")," on Linux, macOS and WSL (Windows Subsystem for\nLinux), needs to be edited to specify the ",(0,r.kt)("a",{parentName:"p",href:"#admin-dids"},"admin DIDs")," allowed to\nset models for indexing, as well as the indexing configuration:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  ...\n  "http-api": {\n    ...\n    "admin-dids": ["did:key:..."]\n  },\n  "indexing": {\n    ...\n    "allow-queries-before-historical-sync": true\n  }\n}\n')),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"If your Ceramic node is already started, it will need to be restarted for the\nchanges to the configuration file to be applied.")))}p.isMDXComponent=!0}}]);