import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'


# Interact with data
The final step of getting started with ComposeDB is interacting with your data using GraphQL. In this guide you will learn how to perform GraphQL queries and mutations using your composite.

:::tip
Want to interact with data using JavaScript instead? See [Client setup](./guides/composedb-client/javascript-client)
:::

## Setup
---
### GraphiQL Server
To interact with data on the network, start a local GraphQL server by running the command below. Note that you have to provide the seed to your `did-private-key` here ‚Äî it is also required for performing mutations, covered below.

```bash
composedb graphql:server --ceramic-url=http://localhost:7007 --graphiql runtime-composite.json --did-private-key=your_private_key --port=5005
```

>‚úèÔ∏è ***Note:*** You can customize the port by configuring the `‚Äî-port` flag.


The output will display a URL, for example:
```bash
GraphQL server is listening on http://localhost:5005/graphql
```

### GraphiQL Web UI
In your browser, visit the URL that your local GraphQL server is listening on. You will see a simple UI that you can use to easily interact with your data:
![GraphQL Web UI](/img/graphiql.png)
  

## Queries
---
One of the most common data interactions you might want to do with ComposeDB is read data from the graph. Using GraphQL, you can query ComposeDB records indexed by your Ceramic node. In the previous guide, we fetched two models from the catalog: `Post` and `SimpleProfile`. Here we will focus on `Post` model.

  

**Query**: Let‚Äôs say you want to check the first 2 entries that were indexed in the Post graph:

  

```graphql
query{
  postIndex(first: 2) {
    edges {
      node {
        text
      }
    }
  }
}
```
  

**Response**:
You should see a response similar to the one below. Here, nodes correspond to stored documents while edges represent the relations between nodes.

  

```json
{
  "data": {
    "postIndex": {
      "edges": [
        {
          "node": {
            "text": "This is my first post."
          }
        },
        {
          "node": {
            "text": "My second post about ComposeDB!"
          }
        }
      ]
    }
  }
}
```
  

**Query:** You have options to retrieve specific records or last `n` indexed records as well. For example, to check the last 3 records, run the query below:


  

```graphql
query{
  postIndex(last: 3) {
    edges {
      node {
        text
      }
    }
  }
}
```
  

## Mutations
---
You can perform mutations to create and update data on ComposeDB.
  
### Creating data


  

**Query:** Let‚Äôs say, you would like to create a post and add it to the graph. To do that, you will have to run a mutation as shown below and pass the actual text as a variable:

  

```graphql
# Mutation to create a new post

mutation CreateNewPost($i: CreatePostInput!){
  createPost(input: $i){
		document{
			id
      text
    }
  }
}
```

**Variables:** The content to store in the post

```json
{
  "i": {
    "content": {
      "text": "A Post created using composites and GraphQL" 
    }
  }
}
```



**Response**: The result of the query above will be a new document with a unique ID and the content you provided:


  

```json
{
  "data": {
    "createPost": {
      "document": {
        "id": "kjzl6kcym7w8y9xlffqruh3v7ou1vn11t8203i6te2i3pliizt65ad3vdh5nl4l",
        "text": "A Post created using composites and GraphQL"
      }
    }
  }
}
```

  
:::note

Stream IDs are unique. The ‚Äúid‚Äù you will see in the response when performing the mutation above will be different.

:::
  

### Updating data
Now let‚Äôs say you want to edit the post you created in the previous step. To update it, you have to run the `UpdatePost` mutation and pass the post‚Äôs unique ID along with the updated content as variables.

:::info

You can find your post‚Äôs ID in the response after you ran the `CreateNewPost` mutation.

:::
  

**Query:**

```graphql
mutation UpdatePost($i: UpdatePostInput!) {
    updatePost(input: $i) {
        document {
            id
            text
        }
    }
}
```

  

**Variables:**

```json
{
  "i": {
    "id": "kjzl6kcym7w8y9xlffqruh3v7ou1vn11t8203i6te2i3pliizt65ad3vdh5nl4l",
    "content": {
      "text": "My best post!"
    }
  }
}
```

This mutation will update the record with ID `kjzl6kcym7w8y9xlffqruh3v7ou1vn11t8203i6te2i3pliizt65ad3vdh5nl4l`.

**Response:**
```json
{
  "data": {
    "updatePost": {
      "document": {
        "id": "kjzl6kcym7w8y9xlffqruh3v7ou1vn11t8203i6te2i3pliizt65ad3vdh5nl4l",
        "text": "My best post!"
      }
    }
  }
}
```

## Authentication
---
Although you can query records created by other accounts, you can only perform mutations on records controlled by your account. This guide did not require your authentication because you previously did that in the [Set up your environment](./set-up-your-environment.mdx) guide.


## Next Steps
---
You‚Äôre on your way to becoming a ComposeDB developer, congratulations! üî• 

Visit [**Next Steps ‚Üí**](./next-steps.mdx) to go deeper on all these concepts and start building your app.

## Related Guides
---
For more detailed descriptions and examples, see:

- [Data Interactions](./guides/data-interactions)
  - [Queries](./guides/data-interactions/queries)
  - [Mutations](./guides/data-interactions/mutations)
- [Client setup](./guides/composedb-client/javascript-client)
- [Authentication](./guides/composedb-client/user-sessions)
